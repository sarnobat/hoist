<!DOCTYPE html>
<html>
<head>
<!-- <script src="//ajax.googleapis.com/ajax/libs/jquery/1.9.1/jquery.min.js"> -->
<script src="jquery/jquery-1.9.1.js">
</script>
<script>

function up(field,id) {
	$.getJSON("http://localhost:9099/helloworld/moveUp?path=" + encodeURIComponent(field),function(result){
		var currentLevel = $("#"+id).parent().attr("id")
		var targetLevel = parseInt(currentLevel) + 1;
		// TODO: handle the case where target level doesn't exist
		var elem = $("#"+id).remove();
		$("#" + targetLevel).append(elem);
	});
}

function down(field,id) {
	$.getJSON("http://localhost:9099/helloworld/moveDown?path=" + encodeURIComponent(field),function(result){
		var currentLevel = $("#"+id).parent().attr("id")
		var targetLevel = parseInt(currentLevel) - 1;
		// TODO: handle the case where target level doesn't exist
		var elem = $("#"+id).remove();
		$("#" + targetLevel).append(elem);
    });
}

function getImages() {
	$("#thumbnails").empty();
	var counter = 1;
	var dir = $("#dir").val();
	$("#thumbnails").append(dir);
    $.getJSON("http://localhost:9099/helloworld/json?dir=" + encodeURIComponent(dir),function(result){
		var keys = [];
		for(var k in result) keys.unshift(parseInt(k));
		keys.sort().reverse();
		for (var i = 0; i < keys.length; i++) {
			var j = keys[i];
			var sectionNumber = j;
			console.debug(sectionNumber);
			var section = $("<div>").attr("id", sectionNumber).attr("style","float : left").attr("align", "center");
			section.append($("<h3>").append("Level " + sectionNumber));
			$("#thumbnails").append(section);
			var v2 = result[j];
			$.each(v2, function(i, field){				
				var id = counter;
				var img = $("<img>").attr("src", field ).attr("height","100px").attr("border","3px").attr("style","border-color:#ffffff;");
				var container = $("<span>").attr('id',id).attr("style","float : left").attr("align", "left");
				var upButton = $("<button>").text("-Up-").click(function(){up(field, id)});
				var downButton = $("<button>").text("Down").click(function(){down(field, id)});
				var thumbnail = container.append("<br>").append(img).append("<br>").append(upButton).append("<br>").append(downButton);
				section.append(thumbnail);
				counter++;
			});
		}
	});
}

$(document).ready(function(){  
	getImages();
	
  
});
</script>
</head>

<body>

	<select id="dir" name="sometext" onchange="getImages()">		
		<option>
			/Users/sarnobat/Windows/misc/teen/primejailbat.com/high/brst
		</option>
		<option>
			/Users/sarnobat/Windows/misc/teen/primejailbat.com/high/legs
		</option>
		<option>
			/Users/sarnobat/Windows/misc/teen/primejailbat.com/high/btt
		</option>
		<option>
			/Users/sarnobat/Windows/Web/Friends/Poorvi/script
		</option>
		<option>
			/Users/sarnobat/Windows/misc/wwe/Sunny
		</option>
		
		<!--option>
			 /Users/sarnobat/Windows/Web/Friends/Poorvi Rohidekar/script_sorted
		</option-->
		<option>
			/Users/sarnobat/Windows/Web/Friends/Poorvi
		</option>
		<option>
			/Users/sarnobat/Windows/misc/ind/btt
		</option>
		<option>
			/Users/sarnobat/Windows/misc/btt
		</option>
		<option>/Users/sarnobat/Windows/misc/ind/brst/amateur</option>
		<option>/Users/sarnobat/Windows/misc/wwe/Bella/btt</option>
		<option>/Users/sarnobat/Windows/misc/brst</option>
		<option>/Users/sarnobat/Windows/misc/teen/primejailbat.com/high/brst</option>
	</select>

	<div id="thumbnails"></div>

</body>
</html>
